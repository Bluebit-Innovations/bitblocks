# AWS EBS Snapshot Guard Terraform Module (`sec_ebs_snapshot_guard`)

The **`sec_ebs_snapshot_guard`** module provides automated and secure management of EBS snapshots, ensuring compliance, security, and optimized lifecycle management of snapshot resources within AWS environments.

---

## ğŸŒŸ Features

* âœ… **Forced Encryption**: IAM policies enforcing mandatory encryption on all snapshots.
* ğŸš¨ **Public Snapshot Alerts**: Real-time alerts via SNS when snapshots are exposed publicly.
* ğŸ“… **Snapshot Lifecycle Management**: Automatic snapshot creation, retention, and deletion using AWS Data Lifecycle Manager (DLM).

---

## ğŸš€ Key Benefits

* **Compliance & Security**: Aligns seamlessly with CIS, NIST, GDPR, and other regulatory frameworks.
* **Production-grade**: Fully tested, robust Terraform module ready for enterprise environments.
* **Easy Integration**: Compatible with both greenfield and brownfield deployments.

---

## ğŸ—‚ Module Structure

```
sec_ebs_snapshot_guard/
â”œâ”€â”€ main.tf
â”œâ”€â”€ variables.tf
â”œâ”€â”€ outputs.tf
â””â”€â”€ examples/
    â”œâ”€â”€ basic.tf
    â””â”€â”€ advanced.tf
```

---

## ğŸ›  Usage Examples

### **Basic Usage**

```hcl
module "basic_snapshot_guard" {
  source      = "../"
  name_prefix = "basic-ebs-guard"

  alert_emails = ["alerts@example.com"]
}
```

### **Advanced Usage**

```hcl
module "advanced_snapshot_guard" {
  source      = "../"
  name_prefix = "advanced-ebs-guard"

  alert_emails       = ["security-team@example.com", "compliance@example.com"]
  retention_count    = 14
  retention_interval = 12
  snapshot_times     = ["00:00", "12:00"]
}
```

---

## ğŸ“¥ Inputs

| Name                 | Description                                    | Type           | Default     | Required |
| -------------------- | ---------------------------------------------- | -------------- | ----------- | -------- |
| `name_prefix`        | Prefix for all resource names.                 | `string`       | -           | Yes      |
| `alert_emails`       | Emails for SNS snapshot exposure alerts.       | `list(string)` | `[]`        | No       |
| `retention_count`    | Number of snapshots to retain.                 | `number`       | `7`         | No       |
| `retention_interval` | Interval between snapshot creation (in hours). | `number`       | `24`        | No       |
| `snapshot_times`     | UTC times (HH\:MM) for scheduled snapshots.    | `list(string)` | `["00:00"]` | No       |

---

## ğŸ“¤ Outputs

| Name                           | Description                                        |
| ------------------------------ | -------------------------------------------------- |
| `snapshot_alert_sns_topic_arn` | ARN of the SNS topic for snapshot exposure alerts. |
| `dlm_lifecycle_policy_arn`     | ARN of the EBS snapshot lifecycle policy.          |

---

## ğŸ”§ Optional Advanced Enhancements (Future Considerations)

* **AWS Security Hub Integration**: Auto-forward alerts for unified security management.
* **Cross-region Snapshot Copies**: Enhanced disaster recovery and geographic redundancy.
* **Tag-based Snapshot Rules**: Granular and tag-driven snapshot management.
* **Slack/MS Teams Alerts**: Integration with collaboration tools for real-time alerting.

---

## ğŸš¨ Requirements

* Terraform >= v1.0
* AWS Provider >= v5.0

---

## ğŸš© IAM Permissions Required

The module automatically handles IAM role and policy creation. Ensure the Terraform execution role/user has permissions for:

* IAM roles and policies (`iam:*`)
* SNS topics and subscriptions (`sns:*`)
* CloudWatch event rules and targets (`events:*`)
* AWS Data Lifecycle Manager (`dlm:*`)

---

## âš ï¸ Important Notes

* The IAM policies generated by this module enforce encryption on snapshot creation. Ensure your teams understand this enforcement to prevent disruption.
* SNS email subscriptions require manual confirmation by recipients upon initial setup.

---

## ğŸš€ How to Integrate?

1. **Clone this repository or module**
2. **Update variables** as per your organizational standards
3. Run Terraform commands:

   ```bash
   terraform init
   terraform plan
   terraform apply
   ```

---

## ğŸ’¡ Troubleshooting & Support

If you encounter any issues, please review Terraform logs or open an issue in this repository. Be sure to include detailed logs and your Terraform/Terraform AWS Provider versions.

---

## ğŸ“š Documentation & Resources

* [AWS DLM Lifecycle Policy](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dlm_lifecycle_policy)
* [AWS IAM Documentation](https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction.html)
* [Terraform AWS Provider](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)

---

## ğŸ“¢ Feedback & Contributions

Your feedback and contributions are always welcome. Feel free to create a pull request or raise an issue.

---

**Developed by \[Bluebit IT Services] - Securing your Cloud, Simplifying Compliance. ğŸš€**
